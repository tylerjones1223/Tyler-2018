# Tyler-2018

## Preparation

- `git clone https://github.com/tylerjones1223/Tyler-2018.git`
- `npm install`
- Set Environment Variables 
  - `DB_HOST` : Database host
  - `DB_PORT` : Database port
  - `DB_NAME` : Database name

## Start up

- `npm start`
- Start up message should be visible:
```
Master Process is online
New Worker Online: PID
New Worker Online: PID
New Worker Online: PID
New Worker Online: PID
Server accepting requests on port 4434
Server accepting requests on port 4434
Server accepting requests on port 4434
Server accepting requests on port 4434
```

## Routes
### /authenticate
- Authenticates user by updating `users` instance `authenticated = true`
- Parameters:
```
method: 'POST'

{
  username: 'username',
    password: 'password'
}
```

### /addPublicKey
- Replaces `user` associated `publicKey` if `user` has been authenticated.
- Parameters:
```
method: 'POST'

{
  username: 'username'
}
```

### /createPrivateKey
- Creates a private pem file.
- Parameters:
```
method: 'GET'
```

### /createUser
- Creates a `user` instance with hashed `password` and `publicKey`. 
- Parameters:
```
method: 'POST'

{
  username: 'username',
    password: 'password'
}
```

### /signMessage
- Signs a message with the provided `user`'s `publicKey`.
- Multiple words must be comma separated: `more,than,one,word`.
- Parameters:
```
method: 'POST'

{
  username: 'username',
    message: 'message'
}
```

### /verify
- Verifies a message was encoded with a `publicKey` associated with the server's privateKey generated by `/createPrivateKey`.
- Parameters:
```
method: 'POST'

{
    message: 'message'
}
```
#### Route list:
```
/authenticate
/addPublicKey
/createPrivateKey
/createUser
/signMessage
/verify
```

## Testing

- The testing file is a simple script that takes two arguments at most.
- For every test, the first argument should be the route. (Reference route list above)
- To begin testing, assuming the preparation steps have been taken, run the command: 
```
npm run tester /createPrivateKey
```
- After this, the server is ready to be tested. Follow the list above for routes and parameters.
- Example request:
```
npm run tester /createUser myUsername myPassword
```
- Tester will return the HTTP status code as well as the response body.